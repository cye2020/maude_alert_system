# ============================================
# 저장소 설정 (S3, Snowflake)
# ============================================

# S3 설정
s3:
  enabled: true
  region: "ap-northeast-2"
  bucket: "maude-dashboard-data-2025-apne2"

  # 인증은 secrets.yaml 또는 환경변수에서

  # Stage 경로 (bucket과 결합하여 s3://bucket/stage 형태로 사용)
  paths:
    bronze: "bronze"
    silver: "silver"
    gold: "gold"
    temp: "temp"
    logs: "logs"

# Snowflake 설정
snowflake:
  # 연결 설정
  connection:
    timeout: 3600  # seconds (1시간)
    login_timeout: 60
    network_timeout: 600  # 10분
    client_session_keep_alive: true

  # 업로드 설정
  upload:
    auto_compress: true
    parallel: 4
    overwrite: true

  # COPY INTO 설정
  copy_into:
    file_format:
      type: "PARQUET"
      compression: "AUTO"

    on_error: "ABORT_STATEMENT"  # ABORT_STATEMENT, CONTINUE, SKIP_FILE
    purge: false  # 로드 후 스테이지에서 파일 삭제 여부
    force: false  # 이미 로드된 파일 재로드 여부

  # 테이블 설정
  tables:
    maude_clustered:
      name: "MAUDE_CLUSTERED"
      source_file: "maude_clustered.parquet"
      create_if_not_exists: true
      schema:
        # 자동으로 parquet 스키마에서 추론
        # 필요시 수동 정의 가능
        auto_infer: true

# 경로 설정
paths:
  local:
    data_file: "./data/silver/maude_clustered.parquet"

# Streamlit 대시보드
streamlit:
  host: "0.0.0.0"
  port: 8501x
  
  data_sources:
    use_s3: true
    use_snowflake: true
    cache_ttl: 3600  # seconds